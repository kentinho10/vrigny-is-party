<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Admin – Gestion du classement</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="style.css">
  <link href="https://fonts.googleapis.com/css2?family=Pacifico&display=swap" rel="stylesheet">
  <style>
    body { margin:0; padding:0; font-family:sans-serif; background:#FAF9F6; color:#333; text-align:center }
    header { padding:1.5rem 1rem 0.5rem }
    h1 { margin:0; font-size:2rem; color:#6F42C1; font-family:'Pacifico', cursive }
    .actions { margin:1rem 0 }
    .actions button { padding:0.5rem 1rem; background:#6F42C1; color:#fff; border:none; border-radius:4px; cursor:pointer }
    table { width:90%; margin:0 auto 1rem; border-collapse:collapse }
    th, td { padding:0.75rem; border:1px solid #ddd; text-align:center }
    th { background:#fafafa }
    .form-admin { display:flex; flex-wrap:wrap; gap:0.5rem; justify-content:center; margin-bottom:2rem }
    .form-admin input, .form-admin button { font-size:1rem; padding:0.5rem }
    .form-admin input[type=file] { padding:0.25rem }
    button.save-btn { background:#6F42C1; color:#fff; border:none; border-radius:4px; cursor:pointer }
    @media (max-width:600px) {
      .form-admin { flex-direction:column }
      .form-admin input, .form-admin button { width:80%; margin:0 auto }
    }
  </style>
</head>
<body>

  <header><h1>Admin – Classement</h1></header>

  <div class="actions">
    <button onclick="location.href='index.html'">← Accueil</button>
  </div>

  <table id="admin-table">
    <thead>
      <tr><th>Avatar</th><th>Nom</th><th>Points</th></tr>
    </thead>
    <tbody></tbody>
  </table>

  <div class="form-admin">
    <input type="file" id="new-avatar" accept="image/*">
    <input type="text" id="new-name" placeholder="Nom du joueur">
    <input type="number" id="new-score" placeholder="Points">
    <button class="save-btn" onclick="save()">Ajouter / Mettre à jour</button>
  </div>

  <script>
    let adminPlayers = JSON.parse(localStorage.getItem('players')||'[]');

    function renderAdmin() {
      const tbody = document.querySelector('#admin-table tbody');
      tbody.innerHTML = '';
      adminPlayers.forEach(p => {
        const avatarImg = p.avatar
          ? `<img src="${p.avatar}" alt="${p.name}" class="avatar" width="40" height="40">`
          : '';
        const tr = document.createElement('tr');
        tr.innerHTML = `<td>${avatarImg}</td><td>${p.name}</td><td>${p.score}</td>`;
        tbody.appendChild(tr);
      });
    }

    function save() {
      const fileInput = document.getElementById('new-avatar');
      const name      = document.getElementById('new-name').value.trim();
      const score     = parseInt(document.getElementById('new-score').value, 10);
      if (!name || isNaN(score)) {
        alert('Nom et points requis');
        return;
      }
      const idx = adminPlayers.findIndex(p => p.name === name);
      function updatePlayers(avatarData) {
        if (idx >= 0) {
          adminPlayers[idx].score = score;
          if (avatarData !== null) adminPlayers[idx].avatar = avatarData;
        } else {
          adminPlayers.push({ name, score, avatar: avatarData });
        }
        localStorage.setItem('players', JSON.stringify(adminPlayers));
        renderAdmin();
      }
      if (fileInput.files.length) {
        const reader = new FileReader();
        reader.onload = () => updatePlayers(reader.result);
        reader.readAsDataURL(fileInput.files[0]);
      } else {
        updatePlayers(null);
      }
      fileInput.value = '';
      document.getElementById('new-name').value = '';
      document.getElementById('new-score').valu
